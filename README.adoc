= SoonQ

A subprocess-based task queue library.

== Design

This repository is organized as follows:

....
SoonQ/
|_ .vscode/
|_ examples/
|_ soonq/
  |_ src/
  |_ poetry.lock
  |_ pyproject.toml
cspell.json
README.adoc
....

*Singleton:*

[python]
....
# Internal instance.
task_roster = TaskRoster()
....

*Usage:*

[python]
....
@soonq.task("SleepTask")
def sleep_task(seconds: int):
    time.sleep(seconds)

# OR... (Can't have both!)

@soonq.task_class
class SleepTask:
    def __init__(self, seconds: int):
        self.seconds = seconds
    def run(self):
        time.sleep(self.seconds)

# MAIN

soonq.enqueue_clones(5, ["SleepTask", 2])
soonq.work_on("SleepTask").until_task_count(3)
....

*Definitions:*

[python]
....
def task(fn: Callable):
    # Generate class like SleepTask.
    return task_class(autogenerated_class)
def task_class(class_: type):
    # Create RegisteredTask instance.
    # Register it with roster.
def work_on(task: str):
    # Spawn worker for given task.
    # Call worker.work()
    #   ^ Returns Work object, which contains until_... defs.
def enqueue(task: str, *args):
    # Pass args as database table row to corresponding queue.
    # (Each task gets its own queue.)
....
